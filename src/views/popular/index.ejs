<div class="min-h-screen bg-transparent text-white">
    <div class="container mx-auto px-4 py-12">
        <!-- High-Impact Cinematic Header -->
        <div class="mb-16 border-l-8 border-purple-600 pl-8">
            <h1 class="text-6xl md:text-8xl font-black uppercase italic tracking-tighter leading-none">
                Popular <span class="text-purple-600">
                    <%= category %>
                </span>
            </h1>
            <p class="text-gray-500 mt-4 font-black uppercase tracking-[0.3em] text-sm md:text-base">
                Koleksi paling trending dalam kategori <%= category %> saat ini
            </p>
        </div>

        <!-- Filter & Navigation (Streaming Style) -->
        <div class="flex flex-col gap-8 mb-16">
            <!-- Category Selection -->
            <div class="flex flex-wrap gap-3 overflow-x-auto pb-4 no-scrollbar">
                <% categories.forEach(cat=> { %>
                    <a href="/popular?category=<%= cat %>&sorttime=<%= sorttime %>"
                        class="flex-shrink-0 px-8 py-3 rounded-sm text-xs font-black uppercase tracking-widest transition-all italic border <%= cat === category ? 'bg-white text-black border-white' : 'bg-transparent text-white/40 border-white/10 hover:border-purple-500 hover:text-white' %>">
                        <%= cat %>
                    </a>
                    <% }); %>
            </div>

            <!-- Sort Timeline -->
            <div class="flex items-center gap-4 bg-white/5 border border-white/5 p-1 rounded-sm self-start">
                <% ['daily', 'weekly' , 'all' ].forEach(time=> { %>
                    <a href="/popular?category=<%= category %>&sorttime=<%= time %>"
                        class="px-6 py-2 text-[10px] font-black uppercase tracking-widest transition-all rounded-sm italic <%= sorttime === time ? 'bg-purple-600 text-white shadow-lg' : 'text-white/30 hover:text-white' %>">
                        <%= time==='all' ? 'All Time' : (time==='daily' ? 'Today' : 'This Week' ) %>
                    </a>
                    <% }); %>
            </div>
        </div>

        <!-- Manga Grid (Cinematic Posters) -->
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-x-6 gap-y-12">
            <% items.forEach((item, index)=> { %>
                <div class="group/card relative">
                    <a href="/manga/<%= item.url.split('/manga/')[1]?.replace('/', '') %>" class="block">
                        <div
                            class="relative aspect-[2/3] overflow-hidden rounded-sm bg-primary-900 shadow-2xl border border-white/5">
                            <img src="<%= wsrvUrl(item.imageUrl) %>" alt="<%= item.title %>"
                                class="w-full h-full object-cover transform group-hover/card:scale-110 transition-transform duration-700"
                                loading="lazy" onerror="this.onerror=null; this.src='/images/fallback.png';">

                            <!-- Cinematic Overlay -->
                            <div
                                class="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent opacity-60 group-hover/card:opacity-90 transition-opacity duration-500">
                            </div>

                            <!-- Hot/Trending Number (Subtle) -->
                            <div
                                class="absolute -bottom-4 -left-2 text-9xl font-black text-white/5 italic opacity-20 pointer-events-none group-hover/card:text-purple-600/20 transition-colors leading-none">
                                <%= index + 1 + (pagination.currentPage - 1) * 20 %>
                            </div>

                            <% if (item.stats && item.stats.views) { %>
                                <div
                                    class="absolute top-3 right-3 bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-sm uppercase tracking-tighter shadow-xl">
                                    <%= item.stats.views %> VIEWS
                                </div>
                                <% } %>

                                    <!-- Quick Action Reveal -->
                                    <div
                                        class="absolute inset-0 flex flex-col justify-end p-6 translate-y-8 opacity-0 group-hover/card:translate-y-0 group-hover/card:opacity-100 transition-all duration-500">
                                        <div class="flex items-center gap-2 mb-4">
                                            <span
                                                class="bg-white text-black text-[10px] font-black px-2 py-1 rounded-sm uppercase italic">Trending</span>
                                            <span
                                                class="text-white text-[10px] font-bold opacity-80 uppercase tracking-widest">
                                                <%= item.type || category %>
                                            </span>
                                        </div>
                                        <button
                                            class="w-full py-3 bg-white text-black text-xs font-black uppercase rounded-sm hover:bg-purple-600 hover:text-white transition-colors tracking-widest italic shadow-2xl">Baca
                                            Sekarang</button>
                                    </div>
                        </div>

                        <div class="mt-6 space-y-2">
                            <h3
                                class="font-black text-white uppercase tracking-tighter text-base line-clamp-1 group-hover/card:text-purple-400 transition-colors italic">
                                <%= item.title %>
                            </h3>
                            <div class="flex items-center justify-between">
                                <span class="text-purple-500 font-bold text-xs uppercase tracking-widest">
                                    <%= item.latestChapter?.title || 'Chapter 00' %>
                                </span>
                            </div>
                        </div>
                    </a>
                </div>
                <% }); %>
        </div>

        <!-- Cinematic Pagination -->
        <div class="flex items-center justify-center gap-8 mt-24">
            <a href="/popular?category=<%= category %>&sorttime=<%= sorttime %>&page=<%= pagination.currentPage > 1 ? pagination.currentPage - 1 : 1 %>"
                class="group flex items-center gap-4 text-xs font-black text-white/40 hover:text-white transition-all uppercase tracking-widest italic <%= pagination.currentPage <= 1 ? 'opacity-0 pointer-events-none' : '' %>">
                <svg class="w-6 h-6 transform group-hover:-translate-x-2 transition-transform" fill="none"
                    stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                Previous
            </a>

            <div class="w-[1px] h-12 bg-white/10"></div>

            <div class="flex flex-col items-center">
                <span class="text-[10px] font-black text-purple-600 uppercase tracking-widest mb-1">Page</span>
                <span class="text-3xl font-black text-white italic">
                    <%= pagination.currentPage %>
                </span>
            </div>

            <div class="w-[1px] h-12 bg-white/10"></div>

            <a href="/popular?category=<%= category %>&sorttime=<%= sorttime %>&page=<%= pagination.currentPage + 1 %>"
                class="group flex items-center gap-4 text-xs font-black text-white/40 hover:text-white transition-all uppercase tracking-widest italic">
                Next
                <svg class="w-6 h-6 transform group-hover:translate-x-2 transition-transform" fill="none"
                    stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </a>
        </div>
    </div>
</div>

<script>
    // Add staggered animation to grid items
    document.addEventListener('DOMContentLoaded', function () {
        const gridItems = document.querySelectorAll('.grid > div');

        gridItems.forEach((item, index) => {
            item.style.setProperty('--animation-order', index + 1);
            item.style.animation = `fadeIn 0.5s ease-out forwards`;
            item.style.animationDelay = `${(index + 1) * 0.05}s`;
            item.style.opacity = '0';
        });
    });
</script>

<style>
    /* Add some cool animations */
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<%- include('../partials/lazyload') %>